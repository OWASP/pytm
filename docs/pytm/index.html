<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>pytm API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>pytm</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">__all__ = [
    &#34;Action&#34;,
    &#34;Actor&#34;,
    &#34;Assumption&#34;,
    &#34;Boundary&#34;,
    &#34;Classification&#34;,
    &#34;TLSVersion&#34;,
    &#34;Data&#34;,
    &#34;Dataflow&#34;,
    &#34;Datastore&#34;,
    &#34;DatastoreType&#34;,
    &#34;Element&#34;,
    &#34;ExternalEntity&#34;,
    &#34;Finding&#34;,
    &#34;Lambda&#34;,
    &#34;Lifetime&#34;,
    &#34;load&#34;,
    &#34;loads&#34;,
    &#34;Process&#34;,
    &#34;Server&#34;,
    &#34;SetOfProcesses&#34;,
    &#34;Threat&#34;,
    &#34;TM&#34;,
]

import sys

from .json import load, loads
from .pytm import (
    TM,
    Action,
    Actor,
    Assumption,
    Boundary,
    Classification,
    Data,
    Dataflow,
    Datastore,
    DatastoreType,
    Element,
    ExternalEntity,
    Finding,
    Lambda,
    Lifetime,
    Process,
    Server,
    SetOfProcesses,
    Threat,
    TLSVersion,
    var,
)


def pdoc_overrides():
    result = {&#34;pytm&#34;: False, &#34;json&#34;: False, &#34;template_engine&#34;: False}
    mod = sys.modules[__name__]
    for name, klass in mod.__dict__.items():
        if not isinstance(klass, type):
            continue
        for i in dir(klass):
            if i in (&#34;check&#34;, &#34;dfd&#34;, &#34;seq&#34;):
                result[f&#34;{name}.{i}&#34;] = False
            attr = getattr(klass, i, {})
            if isinstance(attr, var) and attr.doc != &#34;&#34;:
                result[f&#34;{name}.{i}&#34;] = attr.doc
    return result


__pdoc__ = pdoc_overrides()</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="pytm.report_util" href="report_util.html">pytm.report_util</a></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="pytm.load"><code class="name flex">
<span>def <span class="ident">load</span></span>(<span>fp)</span>
</code></dt>
<dd>
<div class="desc"><p>Load a TM object from an open file containing JSON.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load(fp):
    &#34;&#34;&#34;Load a TM object from an open file containing JSON.&#34;&#34;&#34;
    result = json.load(fp, object_hook=decode)
    if not isinstance(result, TM):
        raise ValueError(&#34;Failed to decode JSON input as TM&#34;)
    return result</code></pre>
</details>
</dd>
<dt id="pytm.loads"><code class="name flex">
<span>def <span class="ident">loads</span></span>(<span>s)</span>
</code></dt>
<dd>
<div class="desc"><p>Load a TM object from a JSON string <em>s</em>.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def loads(s):
    &#34;&#34;&#34;Load a TM object from a JSON string *s*.&#34;&#34;&#34;
    result = json.loads(s, object_hook=decode)
    if not isinstance(result, TM):
        raise ValueError(&#34;Failed to decode JSON input as TM&#34;)
    return result</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="pytm.Action"><code class="flex name class">
<span>class <span class="ident">Action</span></span>
<span>(</span><span>value, names=None, *, module=None, qualname=None, type=None, start=1)</span>
</code></dt>
<dd>
<div class="desc"><p>Action taken when validating a threat model.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Action(Enum):
    &#34;&#34;&#34;Action taken when validating a threat model.&#34;&#34;&#34;

    NO_ACTION = &#34;NO_ACTION&#34;
    RESTRICT = &#34;RESTRICT&#34;
    IGNORE = &#34;IGNORE&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>enum.Enum</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pytm.Action.IGNORE"><code class="name">var <span class="ident">IGNORE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Action.NO_ACTION"><code class="name">var <span class="ident">NO_ACTION</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Action.RESTRICT"><code class="name">var <span class="ident">RESTRICT</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="pytm.Actor"><code class="flex name class">
<span>class <span class="ident">Actor</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>An entity usually initiating actions</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Actor(Element):
    &#34;&#34;&#34;An entity usually initiating actions&#34;&#34;&#34;

    port = varInt(-1, doc=&#34;Default TCP port for outgoing data flows&#34;)
    protocol = varString(&#34;&#34;, doc=&#34;Default network protocol for outgoing data flows&#34;)
    data = varData([], doc=&#34;pytm.Data object(s) in outgoing data flows&#34;)
    inputs = varElements([], doc=&#34;incoming Dataflows&#34;)
    outputs = varElements([], doc=&#34;outgoing Dataflows&#34;)
    isAdmin = varBool(False)

    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)
        TM._actors.append(self)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Element</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Actor.data"><code class="name">var <span class="ident">data</span></code></dt>
<dd>
<div class="desc"><p>pytm.Data object(s) in outgoing data flows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Actor.inputs"><code class="name">var <span class="ident">inputs</span></code></dt>
<dd>
<div class="desc"><p>incoming Dataflows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Actor.isAdmin"><code class="name">var <span class="ident">isAdmin</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Actor.outputs"><code class="name">var <span class="ident">outputs</span></code></dt>
<dd>
<div class="desc"><p>outgoing Dataflows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Actor.port"><code class="name">var <span class="ident">port</span></code></dt>
<dd>
<div class="desc"><p>Default TCP port for outgoing data flows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Actor.protocol"><code class="name">var <span class="ident">protocol</span></code></dt>
<dd>
<div class="desc"><p>Default network protocol for outgoing data flows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Assumption"><code class="flex name class">
<span>class <span class="ident">Assumption</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Assumption used by an Element.
Used to exclude threats on a per-element basis.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Assumption:
    &#34;&#34;&#34;
    Assumption used by an Element.
    Used to exclude threats on a per-element basis.
    &#34;&#34;&#34;
    name = varString(&#34;&#34;, required=True)
    exclude = varStrings([], doc=&#34;A list of threat SIDs to exclude for this assumption. For example: INP01&#34;)
    description = varString(&#34;&#34;, doc=&#34;An additional description of the assumption&#34;)

    def __init__(self, name, **kwargs):
        for key, value in kwargs.items():
            setattr(self, key, value)
        self.name = name</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Assumption.description"><code class="name">var <span class="ident">description</span></code></dt>
<dd>
<div class="desc"><p>An additional description of the assumption</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Assumption.exclude"><code class="name">var <span class="ident">exclude</span></code></dt>
<dd>
<div class="desc"><p>A list of threat SIDs to exclude for this assumption. For example: INP01</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Assumption.name"><code class="name">var <span class="ident">name</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Boundary"><code class="flex name class">
<span>class <span class="ident">Boundary</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Trust boundary groups elements and data with the same trust level.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Boundary(Element):
    &#34;&#34;&#34;Trust boundary groups elements and data with the same trust level.&#34;&#34;&#34;

    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)
        if name not in TM._boundaries:
            TM._boundaries.append(self)

    def _dfd_template(self):
        return &#34;&#34;&#34;subgraph cluster_{uniq_name} {{
    graph [
        fontsize = 10;
        fontcolor = black;
        style = dashed;
        color = {color};
        label = &lt;&lt;i&gt;{label}&lt;/i&gt;&gt;;
    ]

{edges}
}}
&#34;&#34;&#34;

    def dfd(self, **kwargs):
        if self._is_drawn:
            return &#34;&#34;

        self._is_drawn = True

        edges = []
        for e in TM._elements:
            if e.inBoundary != self or e._is_drawn:
                continue
            # The content to draw can include Boundary objects
            edges.append(e.dfd(**kwargs))

        return self._dfd_template().format(
            uniq_name=self._uniq_name(),
            label=self._label(),
            color=self._color(**kwargs),
            edges=indent(&#34;\n&#34;.join(edges), &#34;    &#34;),
        )

    def _color(self, **kwargs):
        if kwargs.get(&#34;colormap&#34;, False):
            return &#34;black&#34;
        else:
            return &#34;firebrick2&#34;

    def parents(self):
        result = []
        parent = self.inBoundary
        while parent is not None:
            result.append(parent)
            parent = parent.inBoundary
        return result</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Element</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="pytm.Boundary.parents"><code class="name flex">
<span>def <span class="ident">parents</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def parents(self):
    result = []
    parent = self.inBoundary
    while parent is not None:
        result.append(parent)
        parent = parent.inBoundary
    return result</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Classification"><code class="flex name class">
<span>class <span class="ident">Classification</span></span>
<span>(</span><span>value, names=None, *, module=None, qualname=None, type=None, start=1)</span>
</code></dt>
<dd>
<div class="desc"><p>An enumeration.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Classification(OrderedEnum):
    UNKNOWN = 0
    PUBLIC = 1
    RESTRICTED = 2
    SENSITIVE = 3
    SECRET = 4
    TOP_SECRET = 5</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.OrderedEnum</li>
<li>enum.Enum</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pytm.Classification.PUBLIC"><code class="name">var <span class="ident">PUBLIC</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Classification.RESTRICTED"><code class="name">var <span class="ident">RESTRICTED</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Classification.SECRET"><code class="name">var <span class="ident">SECRET</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Classification.SENSITIVE"><code class="name">var <span class="ident">SENSITIVE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Classification.TOP_SECRET"><code class="name">var <span class="ident">TOP_SECRET</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Classification.UNKNOWN"><code class="name">var <span class="ident">UNKNOWN</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="pytm.Data"><code class="flex name class">
<span>class <span class="ident">Data</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Represents a single piece of data that traverses the system</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Data:
    &#34;&#34;&#34;Represents a single piece of data that traverses the system&#34;&#34;&#34;

    name = varString(&#34;&#34;, required=True)
    description = varString(&#34;&#34;)
    format = varString(&#34;&#34;)
    classification = varClassification(
        Classification.UNKNOWN,
        required=True,
        doc=&#34;Level of classification for this piece of data&#34;,
    )
    isPII = varBool(
        False,
        doc=&#34;&#34;&#34;Does the data contain personally identifyable information.
Should always be encrypted both in transmission and at rest.&#34;&#34;&#34;,
    )
    isCredentials = varBool(
        False,
        doc=&#34;&#34;&#34;Does the data contain authentication information,
like passwords or cryptographic keys, with or without expiration date.
Should always be encrypted in transmission. If stored, they should be hashed
using a cryptographic hash function.&#34;&#34;&#34;,
    )
    credentialsLife = varLifetime(
        Lifetime.NONE,
        doc=&#34;&#34;&#34;Credentials lifetime, describing if and how
credentials can be revoked. One of:
* NONE - not applicable
* UNKNOWN - unknown lifetime
* SHORT - relatively short expiration date, with an allowed maximum
* LONG - long or no expiration date
* AUTO - no expiration date but can be revoked/invalidated automatically
  in some conditions
* MANUAL - no expiration date but can be revoked/invalidated manually
* HARDCODED - cannot be invalidated at all&#34;&#34;&#34;,
    )
    isStored = varBool(
        False,
        doc=&#34;&#34;&#34;Is the data going to be stored by the target or only processed.
If only derivative data is stored (a hash) it can be set to False.&#34;&#34;&#34;,
    )
    isDestEncryptedAtRest = varBool(False, doc=&#34;Is data encrypted at rest at dest&#34;)
    isSourceEncryptedAtRest = varBool(False, doc=&#34;Is data encrypted at rest at source&#34;)
    carriedBy = varElements([], doc=&#34;Dataflows that carries this piece of data&#34;)
    processedBy = varElements([], doc=&#34;Elements that store/process this piece of data&#34;)

    def __init__(self, name, **kwargs):
        for key, value in kwargs.items():
            setattr(self, key, value)
        self.name = name
        TM._data.append(self)

    def __repr__(self):
        return &#34;&lt;{0}.{1}({2}) at {3}&gt;&#34;.format(
            self.__module__, type(self).__name__, self.name, hex(id(self))
        )

    def __str__(self):
        return &#34;{0}({1})&#34;.format(type(self).__name__, self.name)

    def _safeset(self, attr, value):
        try:
            setattr(self, attr, value)
        except ValueError:
            pass</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Data.carriedBy"><code class="name">var <span class="ident">carriedBy</span></code></dt>
<dd>
<div class="desc"><p>Dataflows that carries this piece of data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.classification"><code class="name">var <span class="ident">classification</span></code></dt>
<dd>
<div class="desc"><p>Level of classification for this piece of data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.credentialsLife"><code class="name">var <span class="ident">credentialsLife</span></code></dt>
<dd>
<div class="desc"><p>Credentials lifetime, describing if and how
credentials can be revoked. One of:
* NONE - not applicable
* UNKNOWN - unknown lifetime
* SHORT - relatively short expiration date, with an allowed maximum
* LONG - long or no expiration date
* AUTO - no expiration date but can be revoked/invalidated automatically
in some conditions
* MANUAL - no expiration date but can be revoked/invalidated manually
* HARDCODED - cannot be invalidated at all</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.description"><code class="name">var <span class="ident">description</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.format"><code class="name">var <span class="ident">format</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.isCredentials"><code class="name">var <span class="ident">isCredentials</span></code></dt>
<dd>
<div class="desc"><p>Does the data contain authentication information,
like passwords or cryptographic keys, with or without expiration date.
Should always be encrypted in transmission. If stored, they should be hashed
using a cryptographic hash function.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.isDestEncryptedAtRest"><code class="name">var <span class="ident">isDestEncryptedAtRest</span></code></dt>
<dd>
<div class="desc"><p>Is data encrypted at rest at dest</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.isPII"><code class="name">var <span class="ident">isPII</span></code></dt>
<dd>
<div class="desc"><p>Does the data contain personally identifyable information.
Should always be encrypted both in transmission and at rest.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.isSourceEncryptedAtRest"><code class="name">var <span class="ident">isSourceEncryptedAtRest</span></code></dt>
<dd>
<div class="desc"><p>Is data encrypted at rest at source</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.isStored"><code class="name">var <span class="ident">isStored</span></code></dt>
<dd>
<div class="desc"><p>Is the data going to be stored by the target or only processed.
If only derivative data is stored (a hash) it can be set to False.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.name"><code class="name">var <span class="ident">name</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Data.processedBy"><code class="name">var <span class="ident">processedBy</span></code></dt>
<dd>
<div class="desc"><p>Elements that store/process this piece of data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Dataflow"><code class="flex name class">
<span>class <span class="ident">Dataflow</span></span>
<span>(</span><span>source, sink, name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>A data flow from a source to a sink</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Dataflow(Element):
    &#34;&#34;&#34;A data flow from a source to a sink&#34;&#34;&#34;

    source = varElement(None, required=True)
    sink = varElement(None, required=True)
    isResponse = varBool(False, doc=&#34;Is a response to another data flow&#34;)
    response = varElement(None, doc=&#34;Another data flow that is a response to this one&#34;)
    responseTo = varElement(None, doc=&#34;Is a response to this data flow&#34;)
    srcPort = varInt(-1, doc=&#34;Source TCP port&#34;)
    dstPort = varInt(-1, doc=&#34;Destination TCP port&#34;)
    tlsVersion = varTLSVersion(
        TLSVersion.NONE,
        required=True,
        doc=&#34;TLS version used.&#34;,
    )
    protocol = varString(&#34;&#34;, doc=&#34;Protocol used in this data flow&#34;)
    data = varData([], doc=&#34;pytm.Data object(s) in incoming data flows&#34;)
    order = varInt(-1, doc=&#34;Number of this data flow in the threat model&#34;)
    implementsCommunicationProtocol = varBool(False)
    note = varString(&#34;&#34;)
    usesVPN = varBool(False)
    usesSessionTokens = varBool(False)
    severity = 0

    def __init__(self, source, sink, name, **kwargs):
        self.source = source
        self.sink = sink
        super().__init__(name, **kwargs)
        TM._flows.append(self)

    def display_name(self):
        if self.order == -1:
            return self.name
        return &#34;({}) {}&#34;.format(self.order, self.name)

    def _dfd_template(self):
        return &#34;&#34;&#34;{source} -&gt; {sink} [
    color = {color};
    fontcolor = {color};
    dir = {direction};
    label = &#34;{label}&#34;;
]
&#34;&#34;&#34;

    def dfd(self, mergeResponses=False, **kwargs):
        self._is_drawn = True

        levels = kwargs.get(&#34;levels&#34;, None)
        if (
            levels
            and not levels &amp; self.levels
            and not (levels &amp; self.source.levels and levels &amp; self.sink.levels)
        ):
            return &#34;&#34;

        color = self._color()

        if kwargs.get(&#34;colormap&#34;, False):
            color = sev_to_color(self.severity)

        direction = &#34;forward&#34;
        label = self._label()
        if mergeResponses and self.response is not None:
            direction = &#34;both&#34;
            label += &#34;\n&#34; + self.response._label()

        return self._dfd_template().format(
            source=self.source._uniq_name(),
            sink=self.sink._uniq_name(),
            direction=direction,
            label=label,
            color=color,
        )

    def hasDataLeaks(self):
        return any(
            d.classification &gt; self.source.maxClassification
            or d.classification &gt; self.sink.maxClassification
            or d.classification &gt; self.maxClassification
            for d in self.data
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Element</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pytm.Dataflow.severity"><code class="name">var <span class="ident">severity</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Dataflow.data"><code class="name">var <span class="ident">data</span></code></dt>
<dd>
<div class="desc"><p>pytm.Data object(s) in incoming data flows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.dstPort"><code class="name">var <span class="ident">dstPort</span></code></dt>
<dd>
<div class="desc"><p>Destination TCP port</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.implementsCommunicationProtocol"><code class="name">var <span class="ident">implementsCommunicationProtocol</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.isResponse"><code class="name">var <span class="ident">isResponse</span></code></dt>
<dd>
<div class="desc"><p>Is a response to another data flow</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.note"><code class="name">var <span class="ident">note</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.order"><code class="name">var <span class="ident">order</span></code></dt>
<dd>
<div class="desc"><p>Number of this data flow in the threat model</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.protocol"><code class="name">var <span class="ident">protocol</span></code></dt>
<dd>
<div class="desc"><p>Protocol used in this data flow</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.response"><code class="name">var <span class="ident">response</span></code></dt>
<dd>
<div class="desc"><p>Another data flow that is a response to this one</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.responseTo"><code class="name">var <span class="ident">responseTo</span></code></dt>
<dd>
<div class="desc"><p>Is a response to this data flow</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.sink"><code class="name">var <span class="ident">sink</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.source"><code class="name">var <span class="ident">source</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.srcPort"><code class="name">var <span class="ident">srcPort</span></code></dt>
<dd>
<div class="desc"><p>Source TCP port</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.tlsVersion"><code class="name">var <span class="ident">tlsVersion</span></code></dt>
<dd>
<div class="desc"><p>TLS version used.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.usesSessionTokens"><code class="name">var <span class="ident">usesSessionTokens</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.usesVPN"><code class="name">var <span class="ident">usesVPN</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pytm.Dataflow.display_name"><code class="name flex">
<span>def <span class="ident">display_name</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def display_name(self):
    if self.order == -1:
        return self.name
    return &#34;({}) {}&#34;.format(self.order, self.name)</code></pre>
</details>
</dd>
<dt id="pytm.Dataflow.hasDataLeaks"><code class="name flex">
<span>def <span class="ident">hasDataLeaks</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def hasDataLeaks(self):
    return any(
        d.classification &gt; self.source.maxClassification
        or d.classification &gt; self.sink.maxClassification
        or d.classification &gt; self.maxClassification
        for d in self.data
    )</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Datastore"><code class="flex name class">
<span>class <span class="ident">Datastore</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>An entity storing data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Datastore(Asset):
    &#34;&#34;&#34;An entity storing data&#34;&#34;&#34;

    onRDS = varBool(False)
    storesLogData = varBool(False)
    storesPII = varBool(
        False,
        doc=&#34;&#34;&#34;Personally Identifiable Information
is any information relating to an identifiable person.&#34;&#34;&#34;,
    )
    storesSensitiveData = varBool(False)
    isSQL = varBool(True)
    isShared = varBool(False)
    hasWriteAccess = varBool(False)
    type = varDatastoreType(
        DatastoreType.UNKNOWN,
        doc=&#34;&#34;&#34;The  type of Datastore, values may be one of:
* UNKNOWN - unknown applicable
* FILE_SYSTEM - files on a file system
* SQL - A SQL Database
* LDAP - An LDAP Server
* AWS_S3 - An S3 Bucket within AWS&#34;&#34;&#34;,
    )

    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)

    def _dfd_template(self):
        return &#34;&#34;&#34;{uniq_name} [
    shape = {shape};
    fixedsize = shape;
    image = &#34;{image}&#34;;
    imagescale = true;
    color = {color};
    fontcolor = black;
    xlabel = &#34;{label}&#34;;
    label = &#34;&#34;;
]
&#34;&#34;&#34;

    def _shape(self):
        return &#34;none&#34;

    def dfd(self, **kwargs):
        self._is_drawn = True

        levels = kwargs.get(&#34;levels&#34;, None)
        if levels and not levels &amp; self.levels:
            return &#34;&#34;

        color = self._color()
        color_file = &#34;black&#34;

        if kwargs.get(&#34;colormap&#34;, False):
            color = sev_to_color(self.severity)
            color_file = color.split(&#34;;&#34;)[0]

        return self._dfd_template().format(
            uniq_name=self._uniq_name(),
            label=self._label(),
            color=color,
            shape=self._shape(),
            image=os.path.join(
                os.path.dirname(__file__), &#34;images&#34;, f&#34;datastore_{color_file}.png&#34;
            ),
        )</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Asset</li>
<li>pytm.pytm.Element</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Datastore.hasWriteAccess"><code class="name">var <span class="ident">hasWriteAccess</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Datastore.isSQL"><code class="name">var <span class="ident">isSQL</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Datastore.isShared"><code class="name">var <span class="ident">isShared</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Datastore.onRDS"><code class="name">var <span class="ident">onRDS</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Datastore.storesLogData"><code class="name">var <span class="ident">storesLogData</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Datastore.storesPII"><code class="name">var <span class="ident">storesPII</span></code></dt>
<dd>
<div class="desc"><p>Personally Identifiable Information
is any information relating to an identifiable person.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Datastore.storesSensitiveData"><code class="name">var <span class="ident">storesSensitiveData</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Datastore.type"><code class="name">var <span class="ident">type</span></code></dt>
<dd>
<div class="desc"><p>The
type of Datastore, values may be one of:
* UNKNOWN - unknown applicable
* FILE_SYSTEM - files on a file system
* SQL - A SQL Database
* LDAP - An LDAP Server
* AWS_S3 - An S3 Bucket within AWS</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.DatastoreType"><code class="flex name class">
<span>class <span class="ident">DatastoreType</span></span>
<span>(</span><span>value, names=None, *, module=None, qualname=None, type=None, start=1)</span>
</code></dt>
<dd>
<div class="desc"><p>An enumeration.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DatastoreType(Enum):
    UNKNOWN = &#34;UNKNOWN&#34;
    FILE_SYSTEM = &#34;FILE_SYSTEM&#34;
    SQL = &#34;SQL&#34;
    LDAP = &#34;LDAP&#34;
    AWS_S3 = &#34;AWS_S3&#34;

    def label(self):
        return self.value.lower().replace(&#34;_&#34;, &#34; &#34;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>enum.Enum</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pytm.DatastoreType.AWS_S3"><code class="name">var <span class="ident">AWS_S3</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.DatastoreType.FILE_SYSTEM"><code class="name">var <span class="ident">FILE_SYSTEM</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.DatastoreType.LDAP"><code class="name">var <span class="ident">LDAP</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.DatastoreType.SQL"><code class="name">var <span class="ident">SQL</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.DatastoreType.UNKNOWN"><code class="name">var <span class="ident">UNKNOWN</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pytm.DatastoreType.label"><code class="name flex">
<span>def <span class="ident">label</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def label(self):
    return self.value.lower().replace(&#34;_&#34;, &#34; &#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Element"><code class="flex name class">
<span>class <span class="ident">Element</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>A generic element</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Element:
    &#34;&#34;&#34;A generic element&#34;&#34;&#34;

    name = varString(&#34;&#34;, required=True)
    description = varString(&#34;&#34;)
    inBoundary = varBoundary(None, doc=&#34;Trust boundary this element exists in&#34;)
    inScope = varBool(True, doc=&#34;Is the element in scope of the threat model&#34;)
    maxClassification = varClassification(
        Classification.UNKNOWN,
        required=False,
        doc=&#34;Maximum data classification this element can handle.&#34;,
    )
    minTLSVersion = varTLSVersion(
        TLSVersion.NONE,
        required=False,
        doc=&#34;&#34;&#34;Minimum TLS version required.&#34;&#34;&#34;,
    )
    findings = varFindings([], doc=&#34;Threats that apply to this element&#34;)
    overrides = varFindings(
        [],
        doc=&#34;&#34;&#34;Overrides to findings, allowing to set
a custom response, CVSS score or override other attributes.&#34;&#34;&#34;,
    )
    assumptions = varAssumptions(
        [],
        doc=&#34;Assumptions about the element. These optionally allow to exclude threats with the given SIDs.&#34;,
    )
    levels = varInts({0}, doc=&#34;List of levels (0, 1, 2, ...) to be drawn in the model.&#34;)
    sourceFiles = varStrings(
        [],
        required=False,
        doc=&#34;Location of the source code that describes this element relative to the directory of the model script.&#34;,
    )
    controls = varControls(None)
    severity = 0

    def __init__(self, name, **kwargs):
        for key, value in kwargs.items():
            setattr(self, key, value)
        self.name = name
        self.controls = Controls()
        self.uuid = uuid.UUID(int=random.getrandbits(128))
        self._is_drawn = False
        TM._elements.append(self)

    def __repr__(self):
        return &#34;&lt;{0}.{1}({2}) at {3}&gt;&#34;.format(
            self.__module__, type(self).__name__, self.name, hex(id(self))
        )

    def __str__(self):
        return &#34;{0}({1})&#34;.format(type(self).__name__, self.name)

    def _uniq_name(self):
        &#34;&#34;&#34;transform name and uuid into a unique string&#34;&#34;&#34;
        h = sha224(str(self.uuid).encode(&#34;utf-8&#34;)).hexdigest()
        name = &#34;&#34;.join(x for x in self.name if x.isalpha())
        return &#34;{0}_{1}_{2}&#34;.format(type(self).__name__.lower(), name, h[:10])

    def check(self):
        return True

    def _dfd_template(self):
        return &#34;&#34;&#34;{uniq_name} [
    shape = {shape};
    color = {color};
    fontcolor = black;
    label = &#34;{label}&#34;;
    margin = 0.02;
]
&#34;&#34;&#34;

    def dfd(self, **kwargs):
        self._is_drawn = True

        levels = kwargs.get(&#34;levels&#34;, None)
        if levels and not levels &amp; self.levels:
            return &#34;&#34;

        color = self._color()
        if kwargs.get(&#34;colormap&#34;, False):
            color = sev_to_color(self.severity)

        return self._dfd_template().format(
            uniq_name=self._uniq_name(),
            label=self._label(),
            color=color,
            shape=self._shape(),
        )

    def _color(self):
        if self.inScope is True:
            return &#34;black&#34;
        else:
            return &#34;grey69&#34;

    def display_name(self):
        return self.name

    def _label(self):
        return &#34;\\n&#34;.join(wrap(self.display_name(), 18))

    def _shape(self):
        return &#34;square&#34;

    def _safeset(self, attr, value):
        try:
            setattr(self, attr, value)
        except ValueError:
            pass

    def oneOf(self, *elements):
        &#34;&#34;&#34;Is self one of a list of Elements&#34;&#34;&#34;
        for element in elements:
            if inspect.isclass(element):
                if isinstance(self, element):
                    return True
            elif self is element:
                return True
        return False

    def crosses(self, *boundaries):
        &#34;&#34;&#34;Does self (dataflow) cross any of the list of boundaries&#34;&#34;&#34;
        if self.source.inBoundary is self.sink.inBoundary:
            return False
        for boundary in boundaries:
            if inspect.isclass(boundary):
                if (
                    (
                        isinstance(self.source.inBoundary, boundary)
                        and not isinstance(self.sink.inBoundary, boundary)
                    )
                    or (
                        not isinstance(self.source.inBoundary, boundary)
                        and isinstance(self.sink.inBoundary, boundary)
                    )
                    or self.source.inBoundary is not self.sink.inBoundary
                ):
                    return True
            elif (self.source.inside(boundary) and not self.sink.inside(boundary)) or (
                not self.source.inside(boundary) and self.sink.inside(boundary)
            ):
                return True
        return False

    def enters(self, *boundaries):
        &#34;&#34;&#34;does self (dataflow) enter into one of the list of boundaries&#34;&#34;&#34;
        return self.source.inBoundary is None and self.sink.inside(*boundaries)

    def exits(self, *boundaries):
        &#34;&#34;&#34;does self (dataflow) exit one of the list of boundaries&#34;&#34;&#34;
        return self.source.inside(*boundaries) and self.sink.inBoundary is None

    def inside(self, *boundaries):
        &#34;&#34;&#34;is self inside of one of the list of boundaries&#34;&#34;&#34;
        for boundary in boundaries:
            if inspect.isclass(boundary):
                if isinstance(self.inBoundary, boundary):
                    return True
            elif self.inBoundary is boundary:
                return True
        return False

    def _attr_values(self):
        klass = self.__class__
        result = {}
        for i in dir(klass):
            if i.startswith(&#34;_&#34;) or callable(getattr(klass, i)):
                continue
            attr = getattr(klass, i, {})
            if isinstance(attr, var):
                value = attr.data.get(self, attr.default)
            else:
                value = getattr(self, i)
            result[i] = value
        return result

    def checkTLSVersion(self, flows):
        return any(f.tlsVersion &lt; self.minTLSVersion for f in flows)

    def _set_severity(self, sev):
        sevs = {
            &#34;very high&#34;: 5,
            &#34;high&#34;: 4,
            &#34;medium&#34;: 3,
            &#34;low&#34;: 2,
            &#34;very low&#34;: 1,
            &#34;info&#34;: 0,
        }

        if sev.lower() not in sevs.keys():
            return

        if self.severity &lt; sevs[sev.lower()]:
            self.severity = sevs[sev.lower()]
        return</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li>pytm.pytm.Actor</li>
<li>pytm.pytm.Asset</li>
<li>pytm.pytm.Boundary</li>
<li>pytm.pytm.Dataflow</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pytm.Element.severity"><code class="name">var <span class="ident">severity</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Element.assumptions"><code class="name">var <span class="ident">assumptions</span></code></dt>
<dd>
<div class="desc"><p>Assumptions about the element. These optionally allow to exclude threats with the given SIDs.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.controls"><code class="name">var <span class="ident">controls</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.description"><code class="name">var <span class="ident">description</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.findings"><code class="name">var <span class="ident">findings</span></code></dt>
<dd>
<div class="desc"><p>Threats that apply to this element</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.inBoundary"><code class="name">var <span class="ident">inBoundary</span></code></dt>
<dd>
<div class="desc"><p>Trust boundary this element exists in</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.inScope"><code class="name">var <span class="ident">inScope</span></code></dt>
<dd>
<div class="desc"><p>Is the element in scope of the threat model</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.levels"><code class="name">var <span class="ident">levels</span></code></dt>
<dd>
<div class="desc"><p>List of levels (0, 1, 2, &hellip;) to be drawn in the model.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.maxClassification"><code class="name">var <span class="ident">maxClassification</span></code></dt>
<dd>
<div class="desc"><p>Maximum data classification this element can handle.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.minTLSVersion"><code class="name">var <span class="ident">minTLSVersion</span></code></dt>
<dd>
<div class="desc"><p>Minimum TLS version required.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.name"><code class="name">var <span class="ident">name</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.overrides"><code class="name">var <span class="ident">overrides</span></code></dt>
<dd>
<div class="desc"><p>Overrides to findings, allowing to set
a custom response, CVSS score or override other attributes.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Element.sourceFiles"><code class="name">var <span class="ident">sourceFiles</span></code></dt>
<dd>
<div class="desc"><p>Location of the source code that describes this element relative to the directory of the model script.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pytm.Element.checkTLSVersion"><code class="name flex">
<span>def <span class="ident">checkTLSVersion</span></span>(<span>self, flows)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def checkTLSVersion(self, flows):
    return any(f.tlsVersion &lt; self.minTLSVersion for f in flows)</code></pre>
</details>
</dd>
<dt id="pytm.Element.crosses"><code class="name flex">
<span>def <span class="ident">crosses</span></span>(<span>self, *boundaries)</span>
</code></dt>
<dd>
<div class="desc"><p>Does self (dataflow) cross any of the list of boundaries</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def crosses(self, *boundaries):
    &#34;&#34;&#34;Does self (dataflow) cross any of the list of boundaries&#34;&#34;&#34;
    if self.source.inBoundary is self.sink.inBoundary:
        return False
    for boundary in boundaries:
        if inspect.isclass(boundary):
            if (
                (
                    isinstance(self.source.inBoundary, boundary)
                    and not isinstance(self.sink.inBoundary, boundary)
                )
                or (
                    not isinstance(self.source.inBoundary, boundary)
                    and isinstance(self.sink.inBoundary, boundary)
                )
                or self.source.inBoundary is not self.sink.inBoundary
            ):
                return True
        elif (self.source.inside(boundary) and not self.sink.inside(boundary)) or (
            not self.source.inside(boundary) and self.sink.inside(boundary)
        ):
            return True
    return False</code></pre>
</details>
</dd>
<dt id="pytm.Element.display_name"><code class="name flex">
<span>def <span class="ident">display_name</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def display_name(self):
    return self.name</code></pre>
</details>
</dd>
<dt id="pytm.Element.enters"><code class="name flex">
<span>def <span class="ident">enters</span></span>(<span>self, *boundaries)</span>
</code></dt>
<dd>
<div class="desc"><p>does self (dataflow) enter into one of the list of boundaries</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def enters(self, *boundaries):
    &#34;&#34;&#34;does self (dataflow) enter into one of the list of boundaries&#34;&#34;&#34;
    return self.source.inBoundary is None and self.sink.inside(*boundaries)</code></pre>
</details>
</dd>
<dt id="pytm.Element.exits"><code class="name flex">
<span>def <span class="ident">exits</span></span>(<span>self, *boundaries)</span>
</code></dt>
<dd>
<div class="desc"><p>does self (dataflow) exit one of the list of boundaries</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def exits(self, *boundaries):
    &#34;&#34;&#34;does self (dataflow) exit one of the list of boundaries&#34;&#34;&#34;
    return self.source.inside(*boundaries) and self.sink.inBoundary is None</code></pre>
</details>
</dd>
<dt id="pytm.Element.inside"><code class="name flex">
<span>def <span class="ident">inside</span></span>(<span>self, *boundaries)</span>
</code></dt>
<dd>
<div class="desc"><p>is self inside of one of the list of boundaries</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def inside(self, *boundaries):
    &#34;&#34;&#34;is self inside of one of the list of boundaries&#34;&#34;&#34;
    for boundary in boundaries:
        if inspect.isclass(boundary):
            if isinstance(self.inBoundary, boundary):
                return True
        elif self.inBoundary is boundary:
            return True
    return False</code></pre>
</details>
</dd>
<dt id="pytm.Element.oneOf"><code class="name flex">
<span>def <span class="ident">oneOf</span></span>(<span>self, *elements)</span>
</code></dt>
<dd>
<div class="desc"><p>Is self one of a list of Elements</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def oneOf(self, *elements):
    &#34;&#34;&#34;Is self one of a list of Elements&#34;&#34;&#34;
    for element in elements:
        if inspect.isclass(element):
            if isinstance(self, element):
                return True
        elif self is element:
            return True
    return False</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.ExternalEntity"><code class="flex name class">
<span>class <span class="ident">ExternalEntity</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>An asset with outgoing or incoming dataflows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ExternalEntity(Asset):
    hasPhysicalAccess = varBool(False)

    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Asset</li>
<li>pytm.pytm.Element</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.ExternalEntity.hasPhysicalAccess"><code class="name">var <span class="ident">hasPhysicalAccess</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Finding"><code class="flex name class">
<span>class <span class="ident">Finding</span></span>
<span>(</span><span>*args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Represents a Finding - the element in question
and a description of the finding</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Finding:
    &#34;&#34;&#34;Represents a Finding - the element in question
    and a description of the finding&#34;&#34;&#34;

    element = varElement(None, required=True, doc=&#34;Element this finding applies to&#34;)
    target = varString(&#34;&#34;, doc=&#34;Name of the element this finding applies to&#34;)
    description = varString(&#34;&#34;, required=True, doc=&#34;Threat description&#34;)
    details = varString(&#34;&#34;, required=True, doc=&#34;Threat details&#34;)
    severity = varString(&#34;&#34;, required=True, doc=&#34;Threat severity&#34;)
    mitigations = varString(&#34;&#34;, required=True, doc=&#34;Threat mitigations&#34;)
    example = varString(&#34;&#34;, required=True, doc=&#34;Threat example&#34;)
    id = varString(&#34;&#34;, required=True, doc=&#34;Finding ID&#34;)
    threat_id = varString(&#34;&#34;, required=True, doc=&#34;Threat ID&#34;)
    references = varString(&#34;&#34;, required=True, doc=&#34;Threat references&#34;)
    condition = varString(&#34;&#34;, required=True, doc=&#34;Threat condition&#34;)
    assumption = varAssumption(None, required=False, doc=&#34;The assumption, that caused this finding to be excluded&#34;)
    response = varString(
        &#34;&#34;,
        required=False,
        doc=&#34;&#34;&#34;Describes how this threat matching this particular asset or dataflow is being handled.
Can be one of:
* mitigated - there were changes made in the modeled system to reduce the probability of this threat occurring or the impact when it does,
* transferred - users of the system are required to mitigate this threat,
* avoided - this asset or dataflow is removed from the system,
* accepted - no action is taken as the probability and/or impact is very low
&#34;&#34;&#34;,
    )
    cvss = varString(&#34;&#34;, required=False, doc=&#34;The CVSS score and/or vector&#34;)

    def __init__(
        self,
        *args,
        **kwargs,
    ):
        if args:
            element = args[0]
        else:
            element = kwargs.pop(&#34;element&#34;, Element(&#34;invalid&#34;))

        self.target = element.name
        self.element = element
        attrs = [
            &#34;description&#34;,
            &#34;details&#34;,
            &#34;severity&#34;,
            &#34;mitigations&#34;,
            &#34;example&#34;,
            &#34;references&#34;,
            &#34;condition&#34;,
        ]
        threat = kwargs.pop(&#34;threat&#34;, None)
        if threat:
            kwargs[&#34;threat_id&#34;] = getattr(threat, &#34;id&#34;)
            for a in attrs:
                # copy threat attrs into kwargs to allow to override them in next step
                kwargs[a] = getattr(threat, a)

        threat_id = kwargs.get(&#34;threat_id&#34;, None)
        for f in element.overrides:
            if f.threat_id != threat_id:
                continue
            for i in dir(f.__class__):
                attr = getattr(f.__class__, i)
                if (
                    i in (&#34;element&#34;, &#34;target&#34;)
                    or i.startswith(&#34;_&#34;)
                    or callable(attr)
                    or not isinstance(attr, var)
                ):
                    continue
                if f in attr.data:
                    kwargs[i] = attr.data[f]
            break

        for k, v in kwargs.items():
            setattr(self, k, v)

    def _safeset(self, attr, value):
        try:
            setattr(self, attr, value)
        except ValueError:
            pass

    def __repr__(self):
        return &#34;&lt;{0}.{1}({2}) at {3}&gt;&#34;.format(
            self.__module__, type(self).__name__, self.id, hex(id(self))
        )

    def __str__(self):
        return f&#34;&#39;{self.target}&#39;: {self.description}\n{self.details}\n{self.severity}&#34;</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Finding.assumption"><code class="name">var <span class="ident">assumption</span></code></dt>
<dd>
<div class="desc"><p>The assumption, that caused this finding to be excluded</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.condition"><code class="name">var <span class="ident">condition</span></code></dt>
<dd>
<div class="desc"><p>Threat condition</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.cvss"><code class="name">var <span class="ident">cvss</span></code></dt>
<dd>
<div class="desc"><p>The CVSS score and/or vector</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.description"><code class="name">var <span class="ident">description</span></code></dt>
<dd>
<div class="desc"><p>Threat description</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.details"><code class="name">var <span class="ident">details</span></code></dt>
<dd>
<div class="desc"><p>Threat details</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.element"><code class="name">var <span class="ident">element</span></code></dt>
<dd>
<div class="desc"><p>Element this finding applies to</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.example"><code class="name">var <span class="ident">example</span></code></dt>
<dd>
<div class="desc"><p>Threat example</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.id"><code class="name">var <span class="ident">id</span></code></dt>
<dd>
<div class="desc"><p>Finding ID</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.mitigations"><code class="name">var <span class="ident">mitigations</span></code></dt>
<dd>
<div class="desc"><p>Threat mitigations</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.references"><code class="name">var <span class="ident">references</span></code></dt>
<dd>
<div class="desc"><p>Threat references</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.response"><code class="name">var <span class="ident">response</span></code></dt>
<dd>
<div class="desc"><p>Describes how this threat matching this particular asset or dataflow is being handled.
Can be one of:
* mitigated - there were changes made in the modeled system to reduce the probability of this threat occurring or the impact when it does,
* transferred - users of the system are required to mitigate this threat,
* avoided - this asset or dataflow is removed from the system,
* accepted - no action is taken as the probability and/or impact is very low</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.severity"><code class="name">var <span class="ident">severity</span></code></dt>
<dd>
<div class="desc"><p>Threat severity</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.target"><code class="name">var <span class="ident">target</span></code></dt>
<dd>
<div class="desc"><p>Name of the element this finding applies to</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Finding.threat_id"><code class="name">var <span class="ident">threat_id</span></code></dt>
<dd>
<div class="desc"><p>Threat ID</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Lambda"><code class="flex name class">
<span>class <span class="ident">Lambda</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>A lambda function running in a Function-as-a-Service (FaaS) environment</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Lambda(Asset):
    &#34;&#34;&#34;A lambda function running in a Function-as-a-Service (FaaS) environment&#34;&#34;&#34;

    onAWS = varBool(True)
    environment = varString(&#34;&#34;)
    implementsAPI = varBool(False)

    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)

    def _dfd_template(self):
        return &#34;&#34;&#34;{uniq_name} [
    shape = {shape};

    color = {color};
    fontcolor = &#34;black&#34;;
    label = &lt;
        &lt;table border=&#34;0&#34; cellborder=&#34;0&#34; cellpadding=&#34;2&#34;&gt;
            &lt;tr&gt;&lt;td&gt;&lt;b&gt;{label}&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;
        &lt;/table&gt;
    &gt;;
]
&#34;&#34;&#34;

    def dfd(self, **kwargs):
        self._is_drawn = True

        levels = kwargs.get(&#34;levels&#34;, None)
        if levels and not levels &amp; self.levels:
            return &#34;&#34;

        color = self._color()

        if kwargs.get(&#34;colormap&#34;, False):
            color = sev_to_color(self.severity)

        return self._dfd_template().format(
            uniq_name=self._uniq_name(),
            label=self._label(),
            color=color,
            shape=self._shape(),
        )

    def _shape(self):
        return &#34;rectangle; style=rounded&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Asset</li>
<li>pytm.pytm.Element</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Lambda.environment"><code class="name">var <span class="ident">environment</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Lambda.implementsAPI"><code class="name">var <span class="ident">implementsAPI</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Lambda.onAWS"><code class="name">var <span class="ident">onAWS</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Lifetime"><code class="flex name class">
<span>class <span class="ident">Lifetime</span></span>
<span>(</span><span>value, names=None, *, module=None, qualname=None, type=None, start=1)</span>
</code></dt>
<dd>
<div class="desc"><p>An enumeration.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Lifetime(Enum):
    # not applicable
    NONE = &#34;NONE&#34;
    # unknown lifetime
    UNKNOWN = &#34;UNKNOWN&#34;
    # relatively short expiration date (time to live)
    SHORT = &#34;SHORT_LIVED&#34;
    # long or no expiration date
    LONG = &#34;LONG_LIVED&#34;
    # no expiration date but revoked/invalidated automatically in some conditions
    AUTO = &#34;AUTO_REVOKABLE&#34;
    # no expiration date but can be invalidated manually
    MANUAL = &#34;MANUALLY_REVOKABLE&#34;
    # cannot be invalidated at all
    HARDCODED = &#34;HARDCODED&#34;

    def label(self):
        return self.value.lower().replace(&#34;_&#34;, &#34; &#34;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>enum.Enum</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pytm.Lifetime.AUTO"><code class="name">var <span class="ident">AUTO</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Lifetime.HARDCODED"><code class="name">var <span class="ident">HARDCODED</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Lifetime.LONG"><code class="name">var <span class="ident">LONG</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Lifetime.MANUAL"><code class="name">var <span class="ident">MANUAL</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Lifetime.NONE"><code class="name">var <span class="ident">NONE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Lifetime.SHORT"><code class="name">var <span class="ident">SHORT</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.Lifetime.UNKNOWN"><code class="name">var <span class="ident">UNKNOWN</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pytm.Lifetime.label"><code class="name flex">
<span>def <span class="ident">label</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def label(self):
    return self.value.lower().replace(&#34;_&#34;, &#34; &#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Process"><code class="flex name class">
<span>class <span class="ident">Process</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>An entity processing data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Process(Asset):
    &#34;&#34;&#34;An entity processing data&#34;&#34;&#34;

    codeType = varString(&#34;Unmanaged&#34;)
    implementsCommunicationProtocol = varBool(False)
    tracksExecutionFlow = varBool(False)
    implementsAPI = varBool(False)
    environment = varString(&#34;&#34;)
    allowsClientSideScripting = varBool(False)

    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)

    def _shape(self):
        return &#34;circle&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Asset</li>
<li>pytm.pytm.Element</li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li>pytm.pytm.SetOfProcesses</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Process.allowsClientSideScripting"><code class="name">var <span class="ident">allowsClientSideScripting</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Process.codeType"><code class="name">var <span class="ident">codeType</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Process.environment"><code class="name">var <span class="ident">environment</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Process.implementsAPI"><code class="name">var <span class="ident">implementsAPI</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Process.implementsCommunicationProtocol"><code class="name">var <span class="ident">implementsCommunicationProtocol</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Process.tracksExecutionFlow"><code class="name">var <span class="ident">tracksExecutionFlow</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Server"><code class="flex name class">
<span>class <span class="ident">Server</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>An entity processing data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Server(Asset):
    &#34;&#34;&#34;An entity processing data&#34;&#34;&#34;

    usesSessionTokens = varBool(False)
    usesCache = varBool(False)
    usesVPN = varBool(False)
    usesXMLParser = varBool(False)

    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)

    def _shape(self):
        return &#34;circle&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Asset</li>
<li>pytm.pytm.Element</li>
</ul>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Server.usesCache"><code class="name">var <span class="ident">usesCache</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Server.usesSessionTokens"><code class="name">var <span class="ident">usesSessionTokens</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Server.usesVPN"><code class="name">var <span class="ident">usesVPN</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Server.usesXMLParser"><code class="name">var <span class="ident">usesXMLParser</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.SetOfProcesses"><code class="flex name class">
<span>class <span class="ident">SetOfProcesses</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>An entity processing data</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SetOfProcesses(Process):
    def __init__(self, name, **kwargs):
        super().__init__(name, **kwargs)

    def _shape(self):
        return &#34;doublecircle&#34;</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.Process</li>
<li>pytm.pytm.Asset</li>
<li>pytm.pytm.Element</li>
</ul>
</dd>
<dt id="pytm.TLSVersion"><code class="flex name class">
<span>class <span class="ident">TLSVersion</span></span>
<span>(</span><span>value, names=None, *, module=None, qualname=None, type=None, start=1)</span>
</code></dt>
<dd>
<div class="desc"><p>An enumeration.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TLSVersion(OrderedEnum):
    NONE = 0
    SSLv1 = 1
    SSLv2 = 2
    SSLv3 = 3
    TLSv10 = 4
    TLSv11 = 5
    TLSv12 = 6
    TLSv13 = 7</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>pytm.pytm.OrderedEnum</li>
<li>enum.Enum</li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="pytm.TLSVersion.NONE"><code class="name">var <span class="ident">NONE</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.TLSVersion.SSLv1"><code class="name">var <span class="ident">SSLv1</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.TLSVersion.SSLv2"><code class="name">var <span class="ident">SSLv2</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.TLSVersion.SSLv3"><code class="name">var <span class="ident">SSLv3</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.TLSVersion.TLSv10"><code class="name">var <span class="ident">TLSv10</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.TLSVersion.TLSv11"><code class="name">var <span class="ident">TLSv11</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.TLSVersion.TLSv12"><code class="name">var <span class="ident">TLSv12</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="pytm.TLSVersion.TLSv13"><code class="name">var <span class="ident">TLSv13</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="pytm.TM"><code class="flex name class">
<span>class <span class="ident">TM</span></span>
<span>(</span><span>name, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Describes the threat model administratively,
and holds all details during a run</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TM:
    &#34;&#34;&#34;Describes the threat model administratively,
    and holds all details during a run&#34;&#34;&#34;

    _flows = []
    _elements = []
    _actors = []
    _assets = []
    _threats = []
    _boundaries = []
    _data = []
    _threatsExcluded = []
    _sf = None
    _duplicate_ignored_attrs = (
        &#34;name&#34;,
        &#34;note&#34;,
        &#34;order&#34;,
        &#34;response&#34;,
        &#34;responseTo&#34;,
        &#34;controls&#34;,
    )
    name = varString(&#34;&#34;, required=True, doc=&#34;Model name&#34;)
    description = varString(&#34;&#34;, required=True, doc=&#34;Model description&#34;)
    threatsFile = varString(
        os.path.dirname(__file__) + &#34;/threatlib/threats.json&#34;,
        onSet=lambda i, v: i._init_threats(),
        doc=&#34;JSON file with custom threats&#34;,
    )
    isOrdered = varBool(False, doc=&#34;Automatically order all Dataflows&#34;)
    mergeResponses = varBool(False, doc=&#34;Merge response edges in DFDs&#34;)
    ignoreUnused = varBool(False, doc=&#34;Ignore elements not used in any Dataflow&#34;)
    findings = varFindings([], doc=&#34;Threats found for elements of this model&#34;)
    excluded_findings = varFindings(
        [],
        doc=&#34;Threats found for elements of this model, &#34;
        &#34;that were excluded on a per-element basis, using the Assumptions class&#34;
    )
    onDuplicates = varAction(
        Action.NO_ACTION,
        doc=&#34;&#34;&#34;How to handle duplicate Dataflow
with same properties, except name and notes&#34;&#34;&#34;,
    )
    assumptions = varStrings(
        [],
        required=False,
        doc=&#34;A list of assumptions about the design/model.&#34;,
    )
    _colormap = False

    def __init__(self, name, **kwargs):
        for key, value in kwargs.items():
            setattr(self, key, value)
        self.name = name
        self._sf = SuperFormatter()
        self._add_threats()
        # make sure generated diagrams do not change, makes sense if they&#39;re commited
        random.seed(0)

    @classmethod
    def reset(cls):
        cls._flows = []
        cls._elements = []
        cls._actors = []
        cls._assets = []
        cls._threats = []
        cls._boundaries = []
        cls._data = []
        cls._threatsExcluded = []

    def _init_threats(self):
        TM._threats = []
        self._add_threats()

    def _add_threats(self):
        try:
            with open(self.threatsFile, &#34;r&#34;, encoding=&#34;utf8&#34;) as threat_file:
                threats_json = json.load(threat_file)
        except (FileNotFoundError, PermissionError, IsADirectoryError) as e:
            raise UIError(
                e, f&#34;while trying to open the the threat file ({self.threatsFile}).&#34;
            )

        for i in threats_json:
            TM._threats.append(Threat(**i))

    def resolve(self):
        finding_count = 0
        excluded_finding_count = 0
        findings = []
        excluded_findings = []
        elements = defaultdict(list)
        for e in TM._elements:
            if not e.inScope:
                continue

            override_ids = set(f.threat_id for f in e.overrides)
            # if element is a dataflow filter out overrides from source and sink
            # because they will be always applied there anyway
            try:
                override_ids -= set(
                    f.threat_id for f in e.source.overrides + e.sink.overrides
                )
            except AttributeError:
                pass

            for t in TM._threats:
                if not t.apply(e) and t.id not in override_ids:
                    continue

                if t.id in TM._threatsExcluded:
                    continue

                _continue = False
                for assumption in e.assumptions:  # type: Assumption
                    if t.id in assumption.exclude:
                        excluded_finding_count += 1
                        f = Finding(e, id=str(excluded_finding_count), threat=t, assumption=assumption)
                        excluded_findings.append(f)
                        _continue = True
                        break
                if _continue:
                    continue

                finding_count += 1
                f = Finding(e, id=str(finding_count), threat=t)
                findings.append(f)
                elements[e].append(f)
                e._set_severity(f.severity)
        self.findings = findings
        self.excluded_findings = excluded_findings
        for e, findings in elements.items():
            e.findings = findings

    def check(self):
        if self.description is None:
            raise ValueError(
                &#34;&#34;&#34;Every threat model should have at least
a brief description of the system being modeled.&#34;&#34;&#34;
            )

        TM._flows = _match_responses(_sort(TM._flows, self.isOrdered))

        self._check_duplicates(TM._flows)

        _apply_defaults(TM._flows, TM._data)

        for e in TM._elements:
            top = Counter(f.threat_id for f in e.overrides).most_common(1)
            if not top:
                continue
            threat_id, count = top[0]
            if count != 1:
                raise ValueError(
                    f&#34;Finding {threat_id} have more than one override in {e}&#34;
                )

        if self.ignoreUnused:
            TM._elements, TM._boundaries = _get_elements_and_boundaries(TM._flows)

        result = True
        for e in TM._elements:
            if not e.check():
                result = False

        if self.ignoreUnused:
            # cannot rely on user defined order if assets are re-used in multiple models
            TM._elements = _sort_elem(TM._elements)

        return result

    def _check_duplicates(self, flows):
        if self.onDuplicates == Action.NO_ACTION:
            return

        index = defaultdict(list)
        for e in flows:
            key = (e.source, e.sink)
            index[key].append(e)

        for flows in index.values():
            for left, right in combinations(flows, 2):
                left_attrs = left._attr_values()
                right_attrs = right._attr_values()
                for a in self._duplicate_ignored_attrs:
                    del left_attrs[a], right_attrs[a]
                if left_attrs != right_attrs:
                    continue
                if self.onDuplicates == Action.IGNORE:
                    right._is_drawn = True
                    continue

                left_controls_attrs = left.controls._attr_values()
                right_controls_attrs = right.controls._attr_values()
                # for a in self._duplicate_ignored_attrs:
                #    del left_controls_attrs[a], right_controls_attrs[a]
                if left_controls_attrs != right_controls_attrs:
                    continue
                if self.onDuplicates == Action.IGNORE:
                    right._is_drawn = True
                    continue

                raise ValueError(
                    &#34;Duplicate Dataflow found between {} and {}: &#34;
                    &#34;{} is same as {}&#34;.format(
                        left.source,
                        left.sink,
                        left,
                        right,
                    )
                )

    def _dfd_template(self):
        return &#34;&#34;&#34;digraph tm {{
    graph [
        fontname = Arial;
        fontsize = 14;
    ]
    node [
        fontname = Arial;
        fontsize = 14;
        rankdir = lr;
    ]
    edge [
        shape = none;
        arrowtail = onormal;
        fontname = Arial;
        fontsize = 12;
    ]
    labelloc = &#34;t&#34;;
    fontsize = 20;
    nodesep = 1;

{edges}
}}&#34;&#34;&#34;

    def dfd(self, **kwargs):
        if &#34;levels&#34; in kwargs:
            levels = kwargs[&#34;levels&#34;]
            if not isinstance(kwargs[&#34;levels&#34;], Iterable):
                kwargs[&#34;levels&#34;] = [levels]
            kwargs[&#34;levels&#34;] = set(levels)

        edges = []
        # since boundaries can be nested sort them by level and start from top
        parents = set(b.inBoundary for b in TM._boundaries if b.inBoundary)

        # TODO boundaries should not be drawn if they don&#39;t contain elements matching requested levels
        # or contain only empty boundaries
        boundary_levels = defaultdict(set)
        max_level = 0
        for b in TM._boundaries:
            if b in parents:
                continue
            boundary_levels[0].add(b)
            for i, p in enumerate(b.parents()):
                i = i + 1
                boundary_levels[i].add(p)
                if i &gt; max_level:
                    max_level = i

        for i in range(max_level, -1, -1):
            for b in sorted(boundary_levels[i], key=lambda b: b.name):
                edges.append(b.dfd(**kwargs))

        if self.mergeResponses:
            for e in TM._flows:
                if e.response is not None:
                    e.response._is_drawn = True
        kwargs[&#34;mergeResponses&#34;] = self.mergeResponses
        for e in TM._elements:
            if not e._is_drawn and not isinstance(e, Boundary) and e.inBoundary is None:
                edges.append(e.dfd(**kwargs))

        return self._dfd_template().format(
            edges=indent(&#34;\n&#34;.join(filter(len, edges)), &#34;    &#34;)
        )

    def _seq_template(self):
        return &#34;&#34;&#34;@startuml
{participants}

{messages}
@enduml&#34;&#34;&#34;

    def seq(self):
        participants = []
        for e in TM._elements:
            if isinstance(e, Actor):
                participants.append(
                    &#39;actor {0} as &#34;{1}&#34;&#39;.format(e._uniq_name(), e.display_name())
                )
            elif isinstance(e, Datastore):
                participants.append(
                    &#39;database {0} as &#34;{1}&#34;&#39;.format(e._uniq_name(), e.display_name())
                )
            elif not isinstance(e, Dataflow) and not isinstance(e, Boundary):
                participants.append(
                    &#39;entity {0} as &#34;{1}&#34;&#39;.format(e._uniq_name(), e.display_name())
                )

        messages = []
        for e in TM._flows:
            message = &#34;{0} -&gt; {1}: {2}&#34;.format(
                e.source._uniq_name(), e.sink._uniq_name(), e.display_name()
            )
            note = &#34;&#34;
            if e.note != &#34;&#34;:
                note = &#34;\nnote left\n{}\nend note&#34;.format(e.note)
            messages.append(&#34;{}{}&#34;.format(message, note))

        return self._seq_template().format(
            participants=&#34;\n&#34;.join(participants), messages=&#34;\n&#34;.join(messages)
        )

    def report(self, template_path):
        try:
            with open(template_path) as file:
                template = file.read()
        except (FileNotFoundError, PermissionError, IsADirectoryError) as e:
            raise UIError(
                e, f&#34;while trying to open the report template file ({template_path}).&#34;
            )

        threats = encode_threat_data(TM._threats)
        findings = encode_threat_data(self.findings)

        elements = encode_element_threat_data(TM._elements)
        assets = encode_element_threat_data(TM._assets)
        actors = encode_element_threat_data(TM._actors)
        boundaries = encode_element_threat_data(TM._boundaries)
        flows = encode_element_threat_data(TM._flows)

        data = {
            &#34;tm&#34;: self,
            &#34;dataflows&#34;: flows,
            &#34;threats&#34;: threats,
            &#34;findings&#34;: findings,
            &#34;elements&#34;: elements,
            &#34;assets&#34;: assets,
            &#34;actors&#34;: actors,
            &#34;boundaries&#34;: boundaries,
            &#34;data&#34;: TM._data,
        }

        return self._sf.format(template, **data)

    def process(self):
        try:
            self._process()
        except UIError as e:
            erromsg = f&#34;&#34;&#34;Failed to excecute
    {e.context}
    {e.error}
&#34;&#34;&#34;
            sys.stderr.write(erromsg)
            sys.exit(127)

    def _process(self):
        self.check()
        result = get_args()
        logging.basicConfig(level=logging.INFO, format=&#34;%(levelname)s: %(message)s&#34;)

        if result.debug:
            logger.setLevel(logging.DEBUG)

        if result.exclude is not None:
            TM._threatsExcluded = result.exclude.split(&#34;,&#34;)

        if result.seq is True:
            print(self.seq())

        if result.dfd is True:
            if result.colormap is True:
                self.resolve()
            print(self.dfd(colormap=result.colormap, levels=(result.levels or set())))

        if (
            result.report is not None
            or result.json is not None
            or result.sqldump is not None
            or result.stale_days is not None
        ):
            self.resolve()

        if result.sqldump is not None:
            self.sqlDump(result.sqldump)

        if result.json:
            try:
                with open(result.json, &#34;w&#34;, encoding=&#34;utf8&#34;) as f:
                    json.dump(self, f, default=to_serializable)
            except (FileExistsError, PermissionError, IsADirectoryError) as e:
                raise UIError(
                    e, f&#34;while trying to write to the result file ({result.json})&#34;
                )

        if result.report is not None:
            print(self.report(result.report))

        if result.describe is not None:
            _describe_classes(result.describe.split())

        if result.list_elements:
            _list_elements()

        if result.list is True:
            [print(&#34;{} - {}&#34;.format(t.id, t.description)) for t in TM._threats]

        if result.stale_days is not None:
            print(self._stale(result.stale_days))

    def _stale(self, days):
        try:
            base_path = os.path.dirname(sys.argv[0])
            tm_mtime = datetime.fromtimestamp(
                os.stat(base_path + f&#34;/{sys.argv[0]}&#34;).st_mtime
            )
        except os.error as err:
            sys.stderr.write(f&#34;{sys.argv[0]} - {err}\n&#34;)
            sys.stderr.flush()
            return &#34;[ERROR]&#34;

        print(f&#34;Checking for code {days} days older than this model.&#34;)

        for e in TM._elements:
            for src in e.sourceFiles:
                try:
                    src_mtime = datetime.fromtimestamp(
                        os.stat(base_path + f&#34;/{src}&#34;).st_mtime
                    )
                except os.error as err:
                    sys.stderr.write(f&#34;{sys.argv[0]} - {err}\n&#34;)
                    sys.stderr.flush()
                    continue

                age = (src_mtime - tm_mtime).days

                # source code is older than model by more than the speficied delta
                if (age) &gt;= days:
                    print(f&#34;This model is {age} days older than {base_path}/{src}.&#34;)
                elif age &lt;= -days:
                    print(
                        f&#34;Model script {sys.argv[0]}&#34;
                        + &#34; is only &#34;
                        + str(-1 * age)
                        + &#34; days newer than source code file &#34;
                        + f&#34;{base_path}/{src}&#34;
                    )

        return &#34;&#34;

    def sqlDump(self, filename):
        try:
            from pydal import DAL, Field
        except ImportError as e:
            raise UIError(
                e, &#34;&#34;&#34;This feature requires the pyDAL package,
    Please install the package via pip or your packagemanger of choice.
                &#34;&#34;&#34;
            )

        @lru_cache(maxsize=None)
        def get_table(db, klass):
            name = klass.__name__
            fields = [
                Field(&#34;SID&#34; if i == &#34;id&#34; else i)
                for i in dir(klass)
                if not i.startswith(&#34;_&#34;) and not callable(getattr(klass, i))
            ]
            return db.define_table(name, fields)

        try:
            rmtree(&#34;./sqldump&#34;)
            os.mkdir(&#34;./sqldump&#34;)
        except OSError as e:
            if e.errno != errno.ENOENT:
                raise
            else:
                os.mkdir(&#34;./sqldump&#34;)

        db = DAL(&#34;sqlite://&#34; + filename, folder=&#34;sqldump&#34;)

        for klass in (
            Server,
            ExternalEntity,
            Dataflow,
            Datastore,
            Actor,
            Process,
            SetOfProcesses,
            Boundary,
            TM,
            Threat,
            Lambda,
            Data,
            Finding,
        ):
            get_table(db, klass)

        for e in TM._threats + TM._data + TM._elements + self.findings + [self]:
            table = get_table(db, e.__class__)
            row = {}
            for k, v in serialize(e).items():
                if k == &#34;id&#34;:
                    k = &#34;SID&#34;
                row[k] = &#34;, &#34;.join(str(i) for i in v) if isinstance(v, list) else v
            db[table].bulk_insert([row])

        db.close()</code></pre>
</details>
<h3>Static methods</h3>
<dl>
<dt id="pytm.TM.reset"><code class="name flex">
<span>def <span class="ident">reset</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@classmethod
def reset(cls):
    cls._flows = []
    cls._elements = []
    cls._actors = []
    cls._assets = []
    cls._threats = []
    cls._boundaries = []
    cls._data = []
    cls._threatsExcluded = []</code></pre>
</details>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.TM.assumptions"><code class="name">var <span class="ident">assumptions</span></code></dt>
<dd>
<div class="desc"><p>A list of assumptions about the design/model.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.description"><code class="name">var <span class="ident">description</span></code></dt>
<dd>
<div class="desc"><p>Model description</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.excluded_findings"><code class="name">var <span class="ident">excluded_findings</span></code></dt>
<dd>
<div class="desc"><p>Threats found for elements of this model, that were excluded on a per-element basis, using the Assumptions class</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.findings"><code class="name">var <span class="ident">findings</span></code></dt>
<dd>
<div class="desc"><p>Threats found for elements of this model</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.ignoreUnused"><code class="name">var <span class="ident">ignoreUnused</span></code></dt>
<dd>
<div class="desc"><p>Ignore elements not used in any Dataflow</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.isOrdered"><code class="name">var <span class="ident">isOrdered</span></code></dt>
<dd>
<div class="desc"><p>Automatically order all Dataflows</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.mergeResponses"><code class="name">var <span class="ident">mergeResponses</span></code></dt>
<dd>
<div class="desc"><p>Merge response edges in DFDs</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.name"><code class="name">var <span class="ident">name</span></code></dt>
<dd>
<div class="desc"><p>Model name</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.onDuplicates"><code class="name">var <span class="ident">onDuplicates</span></code></dt>
<dd>
<div class="desc"><p>How to handle duplicate Dataflow
with same properties, except name and notes</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.TM.threatsFile"><code class="name">var <span class="ident">threatsFile</span></code></dt>
<dd>
<div class="desc"><p>JSON file with custom threats</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pytm.TM.process"><code class="name flex">
<span>def <span class="ident">process</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">    def process(self):
        try:
            self._process()
        except UIError as e:
            erromsg = f&#34;&#34;&#34;Failed to excecute
    {e.context}
    {e.error}
&#34;&#34;&#34;
            sys.stderr.write(erromsg)
            sys.exit(127)</code></pre>
</details>
</dd>
<dt id="pytm.TM.report"><code class="name flex">
<span>def <span class="ident">report</span></span>(<span>self, template_path)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def report(self, template_path):
    try:
        with open(template_path) as file:
            template = file.read()
    except (FileNotFoundError, PermissionError, IsADirectoryError) as e:
        raise UIError(
            e, f&#34;while trying to open the report template file ({template_path}).&#34;
        )

    threats = encode_threat_data(TM._threats)
    findings = encode_threat_data(self.findings)

    elements = encode_element_threat_data(TM._elements)
    assets = encode_element_threat_data(TM._assets)
    actors = encode_element_threat_data(TM._actors)
    boundaries = encode_element_threat_data(TM._boundaries)
    flows = encode_element_threat_data(TM._flows)

    data = {
        &#34;tm&#34;: self,
        &#34;dataflows&#34;: flows,
        &#34;threats&#34;: threats,
        &#34;findings&#34;: findings,
        &#34;elements&#34;: elements,
        &#34;assets&#34;: assets,
        &#34;actors&#34;: actors,
        &#34;boundaries&#34;: boundaries,
        &#34;data&#34;: TM._data,
    }

    return self._sf.format(template, **data)</code></pre>
</details>
</dd>
<dt id="pytm.TM.resolve"><code class="name flex">
<span>def <span class="ident">resolve</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def resolve(self):
    finding_count = 0
    excluded_finding_count = 0
    findings = []
    excluded_findings = []
    elements = defaultdict(list)
    for e in TM._elements:
        if not e.inScope:
            continue

        override_ids = set(f.threat_id for f in e.overrides)
        # if element is a dataflow filter out overrides from source and sink
        # because they will be always applied there anyway
        try:
            override_ids -= set(
                f.threat_id for f in e.source.overrides + e.sink.overrides
            )
        except AttributeError:
            pass

        for t in TM._threats:
            if not t.apply(e) and t.id not in override_ids:
                continue

            if t.id in TM._threatsExcluded:
                continue

            _continue = False
            for assumption in e.assumptions:  # type: Assumption
                if t.id in assumption.exclude:
                    excluded_finding_count += 1
                    f = Finding(e, id=str(excluded_finding_count), threat=t, assumption=assumption)
                    excluded_findings.append(f)
                    _continue = True
                    break
            if _continue:
                continue

            finding_count += 1
            f = Finding(e, id=str(finding_count), threat=t)
            findings.append(f)
            elements[e].append(f)
            e._set_severity(f.severity)
    self.findings = findings
    self.excluded_findings = excluded_findings
    for e, findings in elements.items():
        e.findings = findings</code></pre>
</details>
</dd>
<dt id="pytm.TM.sqlDump"><code class="name flex">
<span>def <span class="ident">sqlDump</span></span>(<span>self, filename)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sqlDump(self, filename):
    try:
        from pydal import DAL, Field
    except ImportError as e:
        raise UIError(
            e, &#34;&#34;&#34;This feature requires the pyDAL package,
Please install the package via pip or your packagemanger of choice.
            &#34;&#34;&#34;
        )

    @lru_cache(maxsize=None)
    def get_table(db, klass):
        name = klass.__name__
        fields = [
            Field(&#34;SID&#34; if i == &#34;id&#34; else i)
            for i in dir(klass)
            if not i.startswith(&#34;_&#34;) and not callable(getattr(klass, i))
        ]
        return db.define_table(name, fields)

    try:
        rmtree(&#34;./sqldump&#34;)
        os.mkdir(&#34;./sqldump&#34;)
    except OSError as e:
        if e.errno != errno.ENOENT:
            raise
        else:
            os.mkdir(&#34;./sqldump&#34;)

    db = DAL(&#34;sqlite://&#34; + filename, folder=&#34;sqldump&#34;)

    for klass in (
        Server,
        ExternalEntity,
        Dataflow,
        Datastore,
        Actor,
        Process,
        SetOfProcesses,
        Boundary,
        TM,
        Threat,
        Lambda,
        Data,
        Finding,
    ):
        get_table(db, klass)

    for e in TM._threats + TM._data + TM._elements + self.findings + [self]:
        table = get_table(db, e.__class__)
        row = {}
        for k, v in serialize(e).items():
            if k == &#34;id&#34;:
                k = &#34;SID&#34;
            row[k] = &#34;, &#34;.join(str(i) for i in v) if isinstance(v, list) else v
        db[table].bulk_insert([row])

    db.close()</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="pytm.Threat"><code class="flex name class">
<span>class <span class="ident">Threat</span></span>
<span>(</span><span>**kwargs)</span>
</code></dt>
<dd>
<div class="desc"><p>Represents a possible threat</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Threat:
    &#34;&#34;&#34;Represents a possible threat&#34;&#34;&#34;

    id = varString(&#34;&#34;, required=True)
    description = varString(&#34;&#34;)
    condition = varString(
        &#34;&#34;,
        doc=&#34;&#34;&#34;a Python expression that should evaluate
to a boolean True or False&#34;&#34;&#34;,
    )
    details = varString(&#34;&#34;)
    likelihood = varString(&#34;&#34;)
    severity = varString(&#34;&#34;)
    mitigations = varString(&#34;&#34;)
    prerequisites = varString(&#34;&#34;)
    example = varString(&#34;&#34;)
    references = varString(&#34;&#34;)
    target = ()

    def __init__(self, **kwargs):
        self.id = kwargs[&#34;SID&#34;]
        self.description = kwargs.get(&#34;description&#34;, &#34;&#34;)
        self.likelihood = kwargs.get(&#34;Likelihood Of Attack&#34;, &#34;&#34;)
        self.condition = kwargs.get(&#34;condition&#34;, &#34;True&#34;)
        target = kwargs.get(&#34;target&#34;, &#34;Element&#34;)
        if not isinstance(target, str) and isinstance(target, Iterable):
            target = tuple(target)
        else:
            target = (target,)
        self.target = tuple(getattr(sys.modules[__name__], x) for x in target)
        self.details = kwargs.get(&#34;details&#34;, &#34;&#34;)
        self.severity = kwargs.get(&#34;severity&#34;, &#34;&#34;)
        self.mitigations = kwargs.get(&#34;mitigations&#34;, &#34;&#34;)
        self.prerequisites = kwargs.get(&#34;prerequisites&#34;, &#34;&#34;)
        self.example = kwargs.get(&#34;example&#34;, &#34;&#34;)
        self.references = kwargs.get(&#34;references&#34;, &#34;&#34;)

    def _safeset(self, attr, value):
        try:
            setattr(self, attr, value)
        except ValueError:
            pass

    def __repr__(self):
        return &#34;&lt;{0}.{1}({2}) at {3}&gt;&#34;.format(
            self.__module__, type(self).__name__, self.id, hex(id(self))
        )

    def __str__(self):
        return &#34;{0}({1})&#34;.format(type(self).__name__, self.id)

    def apply(self, target):
        if not isinstance(target, self.target):
            return None
        return eval(self.condition)</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="pytm.Threat.target"><code class="name">var <span class="ident">target</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="pytm.Threat.condition"><code class="name">var <span class="ident">condition</span></code></dt>
<dd>
<div class="desc"><p>a Python expression that should evaluate
to a boolean True or False</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.description"><code class="name">var <span class="ident">description</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.details"><code class="name">var <span class="ident">details</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.example"><code class="name">var <span class="ident">example</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.id"><code class="name">var <span class="ident">id</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.likelihood"><code class="name">var <span class="ident">likelihood</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.mitigations"><code class="name">var <span class="ident">mitigations</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.prerequisites"><code class="name">var <span class="ident">prerequisites</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.references"><code class="name">var <span class="ident">references</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
<dt id="pytm.Threat.severity"><code class="name">var <span class="ident">severity</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def __get__(self, instance, owner):
    # when x.d is called we get here
    # instance = x
    # owner = type(x)
    if instance is None:
        return self
    return self.data.get(instance, self.default)</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="pytm.Threat.apply"><code class="name flex">
<span>def <span class="ident">apply</span></span>(<span>self, target)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def apply(self, target):
    if not isinstance(target, self.target):
        return None
    return eval(self.condition)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="pytm.report_util" href="report_util.html">pytm.report_util</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="pytm.load" href="#pytm.load">load</a></code></li>
<li><code><a title="pytm.loads" href="#pytm.loads">loads</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="pytm.Action" href="#pytm.Action">Action</a></code></h4>
<ul class="">
<li><code><a title="pytm.Action.IGNORE" href="#pytm.Action.IGNORE">IGNORE</a></code></li>
<li><code><a title="pytm.Action.NO_ACTION" href="#pytm.Action.NO_ACTION">NO_ACTION</a></code></li>
<li><code><a title="pytm.Action.RESTRICT" href="#pytm.Action.RESTRICT">RESTRICT</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Actor" href="#pytm.Actor">Actor</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.Actor.data" href="#pytm.Actor.data">data</a></code></li>
<li><code><a title="pytm.Actor.inputs" href="#pytm.Actor.inputs">inputs</a></code></li>
<li><code><a title="pytm.Actor.isAdmin" href="#pytm.Actor.isAdmin">isAdmin</a></code></li>
<li><code><a title="pytm.Actor.outputs" href="#pytm.Actor.outputs">outputs</a></code></li>
<li><code><a title="pytm.Actor.port" href="#pytm.Actor.port">port</a></code></li>
<li><code><a title="pytm.Actor.protocol" href="#pytm.Actor.protocol">protocol</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Assumption" href="#pytm.Assumption">Assumption</a></code></h4>
<ul class="">
<li><code><a title="pytm.Assumption.description" href="#pytm.Assumption.description">description</a></code></li>
<li><code><a title="pytm.Assumption.exclude" href="#pytm.Assumption.exclude">exclude</a></code></li>
<li><code><a title="pytm.Assumption.name" href="#pytm.Assumption.name">name</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Boundary" href="#pytm.Boundary">Boundary</a></code></h4>
<ul class="">
<li><code><a title="pytm.Boundary.parents" href="#pytm.Boundary.parents">parents</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Classification" href="#pytm.Classification">Classification</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.Classification.PUBLIC" href="#pytm.Classification.PUBLIC">PUBLIC</a></code></li>
<li><code><a title="pytm.Classification.RESTRICTED" href="#pytm.Classification.RESTRICTED">RESTRICTED</a></code></li>
<li><code><a title="pytm.Classification.SECRET" href="#pytm.Classification.SECRET">SECRET</a></code></li>
<li><code><a title="pytm.Classification.SENSITIVE" href="#pytm.Classification.SENSITIVE">SENSITIVE</a></code></li>
<li><code><a title="pytm.Classification.TOP_SECRET" href="#pytm.Classification.TOP_SECRET">TOP_SECRET</a></code></li>
<li><code><a title="pytm.Classification.UNKNOWN" href="#pytm.Classification.UNKNOWN">UNKNOWN</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Data" href="#pytm.Data">Data</a></code></h4>
<ul class="">
<li><code><a title="pytm.Data.carriedBy" href="#pytm.Data.carriedBy">carriedBy</a></code></li>
<li><code><a title="pytm.Data.classification" href="#pytm.Data.classification">classification</a></code></li>
<li><code><a title="pytm.Data.credentialsLife" href="#pytm.Data.credentialsLife">credentialsLife</a></code></li>
<li><code><a title="pytm.Data.description" href="#pytm.Data.description">description</a></code></li>
<li><code><a title="pytm.Data.format" href="#pytm.Data.format">format</a></code></li>
<li><code><a title="pytm.Data.isCredentials" href="#pytm.Data.isCredentials">isCredentials</a></code></li>
<li><code><a title="pytm.Data.isDestEncryptedAtRest" href="#pytm.Data.isDestEncryptedAtRest">isDestEncryptedAtRest</a></code></li>
<li><code><a title="pytm.Data.isPII" href="#pytm.Data.isPII">isPII</a></code></li>
<li><code><a title="pytm.Data.isSourceEncryptedAtRest" href="#pytm.Data.isSourceEncryptedAtRest">isSourceEncryptedAtRest</a></code></li>
<li><code><a title="pytm.Data.isStored" href="#pytm.Data.isStored">isStored</a></code></li>
<li><code><a title="pytm.Data.name" href="#pytm.Data.name">name</a></code></li>
<li><code><a title="pytm.Data.processedBy" href="#pytm.Data.processedBy">processedBy</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Dataflow" href="#pytm.Dataflow">Dataflow</a></code></h4>
<ul class="">
<li><code><a title="pytm.Dataflow.data" href="#pytm.Dataflow.data">data</a></code></li>
<li><code><a title="pytm.Dataflow.display_name" href="#pytm.Dataflow.display_name">display_name</a></code></li>
<li><code><a title="pytm.Dataflow.dstPort" href="#pytm.Dataflow.dstPort">dstPort</a></code></li>
<li><code><a title="pytm.Dataflow.hasDataLeaks" href="#pytm.Dataflow.hasDataLeaks">hasDataLeaks</a></code></li>
<li><code><a title="pytm.Dataflow.implementsCommunicationProtocol" href="#pytm.Dataflow.implementsCommunicationProtocol">implementsCommunicationProtocol</a></code></li>
<li><code><a title="pytm.Dataflow.isResponse" href="#pytm.Dataflow.isResponse">isResponse</a></code></li>
<li><code><a title="pytm.Dataflow.note" href="#pytm.Dataflow.note">note</a></code></li>
<li><code><a title="pytm.Dataflow.order" href="#pytm.Dataflow.order">order</a></code></li>
<li><code><a title="pytm.Dataflow.protocol" href="#pytm.Dataflow.protocol">protocol</a></code></li>
<li><code><a title="pytm.Dataflow.response" href="#pytm.Dataflow.response">response</a></code></li>
<li><code><a title="pytm.Dataflow.responseTo" href="#pytm.Dataflow.responseTo">responseTo</a></code></li>
<li><code><a title="pytm.Dataflow.severity" href="#pytm.Dataflow.severity">severity</a></code></li>
<li><code><a title="pytm.Dataflow.sink" href="#pytm.Dataflow.sink">sink</a></code></li>
<li><code><a title="pytm.Dataflow.source" href="#pytm.Dataflow.source">source</a></code></li>
<li><code><a title="pytm.Dataflow.srcPort" href="#pytm.Dataflow.srcPort">srcPort</a></code></li>
<li><code><a title="pytm.Dataflow.tlsVersion" href="#pytm.Dataflow.tlsVersion">tlsVersion</a></code></li>
<li><code><a title="pytm.Dataflow.usesSessionTokens" href="#pytm.Dataflow.usesSessionTokens">usesSessionTokens</a></code></li>
<li><code><a title="pytm.Dataflow.usesVPN" href="#pytm.Dataflow.usesVPN">usesVPN</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Datastore" href="#pytm.Datastore">Datastore</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.Datastore.hasWriteAccess" href="#pytm.Datastore.hasWriteAccess">hasWriteAccess</a></code></li>
<li><code><a title="pytm.Datastore.isSQL" href="#pytm.Datastore.isSQL">isSQL</a></code></li>
<li><code><a title="pytm.Datastore.isShared" href="#pytm.Datastore.isShared">isShared</a></code></li>
<li><code><a title="pytm.Datastore.onRDS" href="#pytm.Datastore.onRDS">onRDS</a></code></li>
<li><code><a title="pytm.Datastore.storesLogData" href="#pytm.Datastore.storesLogData">storesLogData</a></code></li>
<li><code><a title="pytm.Datastore.storesPII" href="#pytm.Datastore.storesPII">storesPII</a></code></li>
<li><code><a title="pytm.Datastore.storesSensitiveData" href="#pytm.Datastore.storesSensitiveData">storesSensitiveData</a></code></li>
<li><code><a title="pytm.Datastore.type" href="#pytm.Datastore.type">type</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.DatastoreType" href="#pytm.DatastoreType">DatastoreType</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.DatastoreType.AWS_S3" href="#pytm.DatastoreType.AWS_S3">AWS_S3</a></code></li>
<li><code><a title="pytm.DatastoreType.FILE_SYSTEM" href="#pytm.DatastoreType.FILE_SYSTEM">FILE_SYSTEM</a></code></li>
<li><code><a title="pytm.DatastoreType.LDAP" href="#pytm.DatastoreType.LDAP">LDAP</a></code></li>
<li><code><a title="pytm.DatastoreType.SQL" href="#pytm.DatastoreType.SQL">SQL</a></code></li>
<li><code><a title="pytm.DatastoreType.UNKNOWN" href="#pytm.DatastoreType.UNKNOWN">UNKNOWN</a></code></li>
<li><code><a title="pytm.DatastoreType.label" href="#pytm.DatastoreType.label">label</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Element" href="#pytm.Element">Element</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.Element.assumptions" href="#pytm.Element.assumptions">assumptions</a></code></li>
<li><code><a title="pytm.Element.checkTLSVersion" href="#pytm.Element.checkTLSVersion">checkTLSVersion</a></code></li>
<li><code><a title="pytm.Element.controls" href="#pytm.Element.controls">controls</a></code></li>
<li><code><a title="pytm.Element.crosses" href="#pytm.Element.crosses">crosses</a></code></li>
<li><code><a title="pytm.Element.description" href="#pytm.Element.description">description</a></code></li>
<li><code><a title="pytm.Element.display_name" href="#pytm.Element.display_name">display_name</a></code></li>
<li><code><a title="pytm.Element.enters" href="#pytm.Element.enters">enters</a></code></li>
<li><code><a title="pytm.Element.exits" href="#pytm.Element.exits">exits</a></code></li>
<li><code><a title="pytm.Element.findings" href="#pytm.Element.findings">findings</a></code></li>
<li><code><a title="pytm.Element.inBoundary" href="#pytm.Element.inBoundary">inBoundary</a></code></li>
<li><code><a title="pytm.Element.inScope" href="#pytm.Element.inScope">inScope</a></code></li>
<li><code><a title="pytm.Element.inside" href="#pytm.Element.inside">inside</a></code></li>
<li><code><a title="pytm.Element.levels" href="#pytm.Element.levels">levels</a></code></li>
<li><code><a title="pytm.Element.maxClassification" href="#pytm.Element.maxClassification">maxClassification</a></code></li>
<li><code><a title="pytm.Element.minTLSVersion" href="#pytm.Element.minTLSVersion">minTLSVersion</a></code></li>
<li><code><a title="pytm.Element.name" href="#pytm.Element.name">name</a></code></li>
<li><code><a title="pytm.Element.oneOf" href="#pytm.Element.oneOf">oneOf</a></code></li>
<li><code><a title="pytm.Element.overrides" href="#pytm.Element.overrides">overrides</a></code></li>
<li><code><a title="pytm.Element.severity" href="#pytm.Element.severity">severity</a></code></li>
<li><code><a title="pytm.Element.sourceFiles" href="#pytm.Element.sourceFiles">sourceFiles</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.ExternalEntity" href="#pytm.ExternalEntity">ExternalEntity</a></code></h4>
<ul class="">
<li><code><a title="pytm.ExternalEntity.hasPhysicalAccess" href="#pytm.ExternalEntity.hasPhysicalAccess">hasPhysicalAccess</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Finding" href="#pytm.Finding">Finding</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.Finding.assumption" href="#pytm.Finding.assumption">assumption</a></code></li>
<li><code><a title="pytm.Finding.condition" href="#pytm.Finding.condition">condition</a></code></li>
<li><code><a title="pytm.Finding.cvss" href="#pytm.Finding.cvss">cvss</a></code></li>
<li><code><a title="pytm.Finding.description" href="#pytm.Finding.description">description</a></code></li>
<li><code><a title="pytm.Finding.details" href="#pytm.Finding.details">details</a></code></li>
<li><code><a title="pytm.Finding.element" href="#pytm.Finding.element">element</a></code></li>
<li><code><a title="pytm.Finding.example" href="#pytm.Finding.example">example</a></code></li>
<li><code><a title="pytm.Finding.id" href="#pytm.Finding.id">id</a></code></li>
<li><code><a title="pytm.Finding.mitigations" href="#pytm.Finding.mitigations">mitigations</a></code></li>
<li><code><a title="pytm.Finding.references" href="#pytm.Finding.references">references</a></code></li>
<li><code><a title="pytm.Finding.response" href="#pytm.Finding.response">response</a></code></li>
<li><code><a title="pytm.Finding.severity" href="#pytm.Finding.severity">severity</a></code></li>
<li><code><a title="pytm.Finding.target" href="#pytm.Finding.target">target</a></code></li>
<li><code><a title="pytm.Finding.threat_id" href="#pytm.Finding.threat_id">threat_id</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Lambda" href="#pytm.Lambda">Lambda</a></code></h4>
<ul class="">
<li><code><a title="pytm.Lambda.environment" href="#pytm.Lambda.environment">environment</a></code></li>
<li><code><a title="pytm.Lambda.implementsAPI" href="#pytm.Lambda.implementsAPI">implementsAPI</a></code></li>
<li><code><a title="pytm.Lambda.onAWS" href="#pytm.Lambda.onAWS">onAWS</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Lifetime" href="#pytm.Lifetime">Lifetime</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.Lifetime.AUTO" href="#pytm.Lifetime.AUTO">AUTO</a></code></li>
<li><code><a title="pytm.Lifetime.HARDCODED" href="#pytm.Lifetime.HARDCODED">HARDCODED</a></code></li>
<li><code><a title="pytm.Lifetime.LONG" href="#pytm.Lifetime.LONG">LONG</a></code></li>
<li><code><a title="pytm.Lifetime.MANUAL" href="#pytm.Lifetime.MANUAL">MANUAL</a></code></li>
<li><code><a title="pytm.Lifetime.NONE" href="#pytm.Lifetime.NONE">NONE</a></code></li>
<li><code><a title="pytm.Lifetime.SHORT" href="#pytm.Lifetime.SHORT">SHORT</a></code></li>
<li><code><a title="pytm.Lifetime.UNKNOWN" href="#pytm.Lifetime.UNKNOWN">UNKNOWN</a></code></li>
<li><code><a title="pytm.Lifetime.label" href="#pytm.Lifetime.label">label</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Process" href="#pytm.Process">Process</a></code></h4>
<ul class="">
<li><code><a title="pytm.Process.allowsClientSideScripting" href="#pytm.Process.allowsClientSideScripting">allowsClientSideScripting</a></code></li>
<li><code><a title="pytm.Process.codeType" href="#pytm.Process.codeType">codeType</a></code></li>
<li><code><a title="pytm.Process.environment" href="#pytm.Process.environment">environment</a></code></li>
<li><code><a title="pytm.Process.implementsAPI" href="#pytm.Process.implementsAPI">implementsAPI</a></code></li>
<li><code><a title="pytm.Process.implementsCommunicationProtocol" href="#pytm.Process.implementsCommunicationProtocol">implementsCommunicationProtocol</a></code></li>
<li><code><a title="pytm.Process.tracksExecutionFlow" href="#pytm.Process.tracksExecutionFlow">tracksExecutionFlow</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Server" href="#pytm.Server">Server</a></code></h4>
<ul class="">
<li><code><a title="pytm.Server.usesCache" href="#pytm.Server.usesCache">usesCache</a></code></li>
<li><code><a title="pytm.Server.usesSessionTokens" href="#pytm.Server.usesSessionTokens">usesSessionTokens</a></code></li>
<li><code><a title="pytm.Server.usesVPN" href="#pytm.Server.usesVPN">usesVPN</a></code></li>
<li><code><a title="pytm.Server.usesXMLParser" href="#pytm.Server.usesXMLParser">usesXMLParser</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.SetOfProcesses" href="#pytm.SetOfProcesses">SetOfProcesses</a></code></h4>
</li>
<li>
<h4><code><a title="pytm.TLSVersion" href="#pytm.TLSVersion">TLSVersion</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.TLSVersion.NONE" href="#pytm.TLSVersion.NONE">NONE</a></code></li>
<li><code><a title="pytm.TLSVersion.SSLv1" href="#pytm.TLSVersion.SSLv1">SSLv1</a></code></li>
<li><code><a title="pytm.TLSVersion.SSLv2" href="#pytm.TLSVersion.SSLv2">SSLv2</a></code></li>
<li><code><a title="pytm.TLSVersion.SSLv3" href="#pytm.TLSVersion.SSLv3">SSLv3</a></code></li>
<li><code><a title="pytm.TLSVersion.TLSv10" href="#pytm.TLSVersion.TLSv10">TLSv10</a></code></li>
<li><code><a title="pytm.TLSVersion.TLSv11" href="#pytm.TLSVersion.TLSv11">TLSv11</a></code></li>
<li><code><a title="pytm.TLSVersion.TLSv12" href="#pytm.TLSVersion.TLSv12">TLSv12</a></code></li>
<li><code><a title="pytm.TLSVersion.TLSv13" href="#pytm.TLSVersion.TLSv13">TLSv13</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.TM" href="#pytm.TM">TM</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.TM.assumptions" href="#pytm.TM.assumptions">assumptions</a></code></li>
<li><code><a title="pytm.TM.description" href="#pytm.TM.description">description</a></code></li>
<li><code><a title="pytm.TM.excluded_findings" href="#pytm.TM.excluded_findings">excluded_findings</a></code></li>
<li><code><a title="pytm.TM.findings" href="#pytm.TM.findings">findings</a></code></li>
<li><code><a title="pytm.TM.ignoreUnused" href="#pytm.TM.ignoreUnused">ignoreUnused</a></code></li>
<li><code><a title="pytm.TM.isOrdered" href="#pytm.TM.isOrdered">isOrdered</a></code></li>
<li><code><a title="pytm.TM.mergeResponses" href="#pytm.TM.mergeResponses">mergeResponses</a></code></li>
<li><code><a title="pytm.TM.name" href="#pytm.TM.name">name</a></code></li>
<li><code><a title="pytm.TM.onDuplicates" href="#pytm.TM.onDuplicates">onDuplicates</a></code></li>
<li><code><a title="pytm.TM.process" href="#pytm.TM.process">process</a></code></li>
<li><code><a title="pytm.TM.report" href="#pytm.TM.report">report</a></code></li>
<li><code><a title="pytm.TM.reset" href="#pytm.TM.reset">reset</a></code></li>
<li><code><a title="pytm.TM.resolve" href="#pytm.TM.resolve">resolve</a></code></li>
<li><code><a title="pytm.TM.sqlDump" href="#pytm.TM.sqlDump">sqlDump</a></code></li>
<li><code><a title="pytm.TM.threatsFile" href="#pytm.TM.threatsFile">threatsFile</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="pytm.Threat" href="#pytm.Threat">Threat</a></code></h4>
<ul class="two-column">
<li><code><a title="pytm.Threat.apply" href="#pytm.Threat.apply">apply</a></code></li>
<li><code><a title="pytm.Threat.condition" href="#pytm.Threat.condition">condition</a></code></li>
<li><code><a title="pytm.Threat.description" href="#pytm.Threat.description">description</a></code></li>
<li><code><a title="pytm.Threat.details" href="#pytm.Threat.details">details</a></code></li>
<li><code><a title="pytm.Threat.example" href="#pytm.Threat.example">example</a></code></li>
<li><code><a title="pytm.Threat.id" href="#pytm.Threat.id">id</a></code></li>
<li><code><a title="pytm.Threat.likelihood" href="#pytm.Threat.likelihood">likelihood</a></code></li>
<li><code><a title="pytm.Threat.mitigations" href="#pytm.Threat.mitigations">mitigations</a></code></li>
<li><code><a title="pytm.Threat.prerequisites" href="#pytm.Threat.prerequisites">prerequisites</a></code></li>
<li><code><a title="pytm.Threat.references" href="#pytm.Threat.references">references</a></code></li>
<li><code><a title="pytm.Threat.severity" href="#pytm.Threat.severity">severity</a></code></li>
<li><code><a title="pytm.Threat.target" href="#pytm.Threat.target">target</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>